---
title: Cards
permalink: /card
aside: false
excerpt: Interactive card searcher.
---

<style>
  .wc__controls {
    margin-bottom: 1em;
    display: flex;
    flex-direction: column;
    gap: 0.5em;
  }

  .wc__controls__search {
    display: flex;
    align-items: center;
    flex-grow: 1;
  }

  .wc__controls__search input {
    border: none;
    border-bottom: 4px solid #fc4d50;
    margin-left: 0.5em;
    flex-grow: 1;
    max-width: 20em;
  }

  .wc__controls__filters {
    display: flex;
    gap: 0.2em;
    align-items: center;
  }

  .wc__controls__filters select {
    border: none;
    background: none;
    border-bottom: 4px solid red;
  }

  .wc__gallery {
    display: grid;
    grid-template-columns: repeat(1, 1fr);
    gap: 1em;
  }

  @media (min-width: 350px) {
    .wc__gallery {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 750px) {
    .wc__controls {
      flex-direction: row;
    }

    .wc__gallery {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  .wc__item {
    display: flex;
    justify-content: center;
    overflow: hidden;
    border-radius: 0.5em;
    border: 0.2em solid var(--type-border, #000);
    box-sizing: border-box;
    position: relative;
  }

  .wc__item[data-type="T"] {
    --type-border: lightcoral;
  }

  .wc__item[data-type="S"] {
    --type-border: mediumpurple;
  }

  .wc__item[data-type="P"] {
    --type-border: goldenrod;
  }

  .wc__item[data-type="M"] {
    --type-border: cornflowerblue;
  }

  .wc__item[data-type="X"] {
    --type-border: seagreen;
  }

  .wc__image {
    display: block;
    height: 350px;
    max-width: unset !important;
  }

  .wc__missing {
    background: rgba(252, 77, 80, 0.5);
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 2em;
    line-height: 2em;
    text-align: center;
    color: white;
  }

  [hidden] {
    display: none;
  }
</style>

<div class="wc__controls">
  <div class="wc__controls__search">
    <i class="fas fa-search"></i>
    <input
      type="search"
      id="wc-search"
      title="Search for cards by tag, character, or release"
      placeholder="Search by tag or character"
    />
  </div>

  <div style="margin-right: auto"></div>

  <div class="wc__controls__filters">
    <select name="wc-type" title="Filter cards by type">
      <option value="">All</option>
      {% for type in site.data.card_types %}
      <option value={{ type[0] }}>{{ type[1] }}</option>
      {% endfor %}
    </select>

    <select name="wc-release" title="Filter cards by release set">
      <option value="">All</option>
      {% assign _releases = site.data.cards | map: "release" | uniq | reverse %}
      {% for release in _releases %}
      <option value="{{ release }}">{{ release }}</option>
      {% endfor %}
    </select>

    <!-- <select name="wc-rarity" title="Filter cards by rarity">
      <option value="">All</option>
      <option value="UR">UR</option>
      <option value="SSR">SSR</option>
      <option value="SR">SR</option>
      <option value="R">R</option>
    </select> -->
  </div>

  <!-- TODO: Pagination -->
  <!-- <select name="wc-limit" id="wc-limit">
    <option value="15">15</option>
    <option value="30">30</option>
    <option value="50">50</option>
    <option value="">All</option>
  </select> -->
</div>

<div class="wc__gallery">
  Loading...
</div>

<script type="text/javascript">
  (function() {
    const CARDS = [
      {%- for card in site.data.cards -%}
      {
        "type": {{ card.type | jsonify }},
        "witch": {{ card.witch | jsonify }},
        "rarity": {{ card.rarity | jsonify }},
        "release": {{ card.release | jsonify }},
        "tags": {{ card.tags | jsonify }},
        "has_translation": {% if card.spell %}true{% else %}false{% endif %},
      },
      {%- endfor -%}
    ];

    function loadCards(cards) {
      const $gallery = $(".wc__gallery");
      $gallery.empty();
      cards.forEach(function(card) {
        const alt = `${card['release']} ${card['rarity']} ${card['witch']}`;
        const slug = alt.replaceAll(" ", "-").toLowerCase();
        $gallery.append(`
          <div class="wc__item" data-type="${card['type']}">
            <a href="{{site.baseurl}}{{ page.url }}/${slug}">
              <img
                class="wc__image"
                src="{{ site.baseurl }}/assets/cards/${slug}.jpg"
                alt="${alt}"
              />
            </a>
            ${card['has_translation'] ? "" : `
            <div class="wc__missing">
              Missing translation
            </div>
            `}
          </div>
        `);
      });
    }

    function filterCards(val) {
      if (!val) return CARDS;

      const terms = val.trim().split(" ").map(function(v) { return v.toLowerCase(); });
      return CARDS.filter(function(item) {
        return terms.every(function(term) {
          const tagsMatch = item["tags"] && item["tags"].some(function(tag) {
            return tag.toLowerCase().includes(term);
          });
          if (tagsMatch) return true;

          const witchMatches = item["witch"] && item["witch"].toLowerCase().includes(term);
          if (witchMatches) return true;

          const setMatches = item["release"] && item["release"].toLowerCase().includes(term);
          if (setMatches) return true;

          return false;
        });
      });
    }

    function loadCardsFiltered(query, type, release) {
      let cards = filterCards(query);

      if (type) {
        cards = cards.filter(function(card) {
          return card.type === type;
        });
      }

      if (release) {
        cards = cards.filter(function(card) {
          return card.release === release;
        })
      }

      loadCards(cards);
    }

    const SOURCES = window.TEXT_VARIABLES.sources;
    window.Lazyload.js(SOURCES.jquery, function() {
      $search = $("input#wc-search");
      $type = $("select[name=wc-type]");
      $release = $("select[name=wc-release]");

      function _loadCards() {
        loadCardsFiltered($search.val(), $type.val(), $release.val());
      }

      // Eager searching
      $search.keyup(_loadCards);
      $type.change(_loadCards)
      $release.change(_loadCards);

      // On-load
      _loadCards();
    });
  })();
</script>
